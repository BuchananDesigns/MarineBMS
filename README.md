## MarineBMS
#Schematics for a Battery Management System to be installed in marine application for live-aboard cruisers using LiFePO4 cells. Designed for centrally monitored 12V-24V systems with high precision of cell voltages in a dual-bus topography.

This is a tool providing automatic monitoring and control of power sources and uses in order to protect marine equipment and the lithium batteries. While the standard application will track and log parameters, it does not provide graphing services which is really unnecessary. Instead select data is transmitted over the data network to MFD. Similarly, warning alarms are likely to occur when nobody is around, or may not be able to hear/react before damage occurs. Instead it is critical that the BMS functions on its own, recover itself, and provide users with enough information to know the general state without overdoing the detail.

As demand for household power increases, along with a desire for inverters powering 120V systems, it becomes desirable to use lithium ion batteries instead of lead acid. For safety reasons the most likely sub-type is Lithium Iron Phosphate using prismatic cells. LiFePO4 have a very flat charge/discharge curve so getting accurate voltage reading is important. For the longest lifespan, and considering that the battery will likely be sized for at least 24 hours between charges, it is likely that voltage ranges will be conservative and the desire will be to operate the battery in the 20%-95% charge range.

Using a dual-bus topography has issues to overcome, issues that do not exist with lead acid batteries that can be over charged. A key requirement is ensuring that in no situation can charge sources be disconnected from batteries while outputting power. Even when connected to shore power, the charger (or inverter charger) is not a power source and cannot be connected to loads without the batteries present to handle varying power demand. Each system must be programmed to setting more conservative than the BMS which will then be the backup system. In the ideal world, the main relays will never open.

To support the most battery capacity, while keeping the size each cell below 200 Ah (ideally each cell should be below 100 Ah) then it is likely that cells will be connected in parallel then each parallel pack connected in series. This BMS is designed to monitor 24 thermistors (temperature probes). These can be either placed on each cell, or between cells allowing upto 6P8S configurations.

Each cell, or parallel group of cells, must have the voltage accurately monitored. This BMS is designed with an operational amplifier with resistor selection to provide approximately 5 times the resolution of the target operating range compared to using a voltage divider. This is done by powering a dedicated 1.25 volt reference and multiplying the multiplexed voltage leads to a differential ADC with an expected 13 bits of accuracy. With the 0.01% resistors selected the voltage range will be 2.87V to 3.50V. Changing the resistor selection would allow wider ranges at the cost of resolution. This is generally unnecessary and undesirable for marine installations which are focused on lifespan instead of getting a few extra amp hours. Our target maximum charge voltage will be 3.45 volts per cell, and target low voltage cut-off of 3.00 volts per cell, allowing a very small reserve.

Over 24 hours, 365 days per year would draw a lot of amps to hold relays closed 24/7. In low power mode we donâ€™t want to hold relays open either. As such the default will be bi-latching relays such as the V23130 from Tyco Electronics. At temperatures experienced out cruising these are rated at 250 amps continuous, and can break upto 1500 amps. In the unlikely situation that higher currents are required the relays can be paralleled. This BMS provides 12V power to relays for both charge and house busses. There are a further four 12V relay controls to operate other charge sources. Finally in a twisted pair setup there are digital (though it might be possible to reroute for analog) outputs.

Knowing cell voltage is one thing, but to accurately know how the battery is preforming also requires current information. Four inputs are multiplexed to an instrumental amplifier. If setup this will allow separate tracking of sources and uses. Of interest might be separation of charge sources: alternators, and solar; while tracking electricity usage by itself. 

For communication this BMS has a CANbus interface. Electrically this is compatible with NMEA2000 and the software should be able to provide messaging to the network. Though this interface it should be possible to provide voltage, state of charge, and usage to the user.
